<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Module Tracker</title>
<style>
:root{
  --blue:#0078D4; --gold:#FFC107; --bg:#F4F8FC; --card:#fff;
  --green:#28a745; --orange:#ff9800; --darkbg:#1f2937; --darktext:#f4f4f4;
  --shadow:0 6px 16px rgba(0,0,0,.08);
}
body{margin:0;font-family:Segoe UI,sans-serif;background:var(--bg);color:#1f2937;transition:background .3s,color .3s;}
body.dark{background:var(--darkbg);color:var(--darktext);}
header{background:var(--blue);color:#fff;padding:20px;text-align:center}
header a{color:white;text-decoration:none;}
.toggle-btn{background:var(--blue);color:#fff;border:none;padding:8px 14px;border-radius:6px;cursor:pointer;margin:6px;}
.wrap{max-width:1000px;margin:22px auto;padding:0 16px}
.card{background:var(--card);border-radius:12px;box-shadow:var(--shadow);padding:18px;margin-bottom:16px}
.display{font-size:2rem;font-weight:bold;color:var(--blue);margin:10px 0}
.module{margin-top:14px;padding:12px;background:#f9f9ff;border-left:4px solid var(--green);border-radius:8px}
.tag{padding:2px 6px;border-radius:4px;font-size:.75rem;font-weight:600;color:#fff;margin-right:6px;}
.tag.rnbp{background:var(--blue);}
.tag.respite{background:var(--gold);color:#000;}
.bar{height:18px;background:#e5e7eb;border-radius:9px;overflow:hidden;margin-top:8px}
.fill{height:100%;width:0;background:var(--green);transition:width .3s ease}
.weekly-summary{border-left:6px solid var(--green);}
.summary-bar{height:18px;background:#e5e7eb;border-radius:9px;overflow:hidden;margin:.6rem 0}
.summary-fill{height:100%;width:0;background:var(--green);transition:width .3s ease}
</style>
</head>
<body>
<header>
  <h1><a href="index.html">üìä Module Tracker</a></h1>
  <p>Track per‚Äëday progress and timer</p>
  <button class="toggle-btn" onclick="toggleDark()">Toggle Dark Mode</button>
</header>

<main class="wrap">
<section class="card weekly-summary">
  <h2>üìä Weekly Progress</h2>
  <div class="summary-bar"><div id="weekly-fill" class="summary-fill"></div></div>
  <p id="weekly-count">0 of 0 tasks completed</p>
</section>

<section class="card">
  <h2>‚è± Study Timer</h2>
  <div id="moduleTimer" class="display">25:00</div>
  <button onclick="startTimer()">Start</button>
  <button onclick="resetTimer()">Reset</button>
</section>

<section class="card module">
  <h3><span class="tag rnbp">RNBP</span> NRSG 103</h3>
  <label><input type="checkbox" /> Orientation</label>
  <label><input type="checkbox" /> Reading</label>
  <div class="bar"><div id="mod1" class="fill"></div></div>
</section>
<section class="card module">
  <h3><span class="tag respite">Respite</span> Lesson 1</h3>
  <label><input type="checkbox" /> Intro Reading</label>
  <label><input type="checkbox" /> Lesson Prep</label>
  <div class="bar"><div id="mod2" class="fill"></div></div>
</section>
</main>

<script>
// === Dark mode ===
function toggleDark(){
  document.body.classList.toggle('dark');
  localStorage.setItem('theme', document.body.classList.contains('dark')?'dark':'light');
}
if(localStorage.getItem('theme')==='dark'){document.body.classList.add('dark');}

// === Checkbox save/load with date ===
const todayKey = new Date().toISOString().slice(0,10);
document.querySelectorAll("input[type='checkbox']").forEach(cb=>{
  const key = `${todayKey}:${cb.closest('h3')?.textContent || 'general'}:${cb.parentNode.textContent.trim()}`;
  const saved = localStorage.getItem(key);
  if(saved === 'true') cb.checked = true;
  cb.addEventListener('change',()=>{
    localStorage.setItem(key, cb.checked);
    updateWeeklyProgress();
    updateModuleBars();
  });
});

// === Weekly progress (last 7 days only) ===
function updateWeeklyProgress(){
  const now = new Date(); let total=0, done=0;
  for(let i=0;i<7;i++){
    const d = new Date(now); d.setDate(now.getDate()-i);
    const prefix = d.toISOString().slice(0,10);
    for(let j=0;j<localStorage.length;j++){
      const k = localStorage.key(j);
      if(k.startsWith(prefix)){
        total++;
        if(localStorage.getItem(k)==='true') done++;
      }
    }
  }
  const pct = total ? Math.round(done/total*100) : 0;
  document.getElementById('weekly-fill').style.width = pct + '%';
  document.getElementById('weekly-count').textContent = `${done} of ${total} tasks completed (last 7 days)`;
}
updateWeeklyProgress();

// === Per-module bar fill ===
function updateModuleBars(){
  document.querySelectorAll('.module').forEach(module=>{
    const checks = module.querySelectorAll("input[type='checkbox']");
    const fill = module.querySelector('.fill');
    if(checks.length && fill){
      const done = [...checks].filter(c=>c.checked).length;
      const pct = Math.round((done/checks.length)*100);
      fill.style.width = pct + '%';
    }
  });
}
updateModuleBars();

// === Timer logic ===
let moduleInterval, moduleTimeLeft = 25 * 60;

function updateModuleTimer(){
  const m = String(Math.floor(moduleTimeLeft / 60)).padStart(2, '0');
  const s = String(moduleTimeLeft % 60).padStart(2, '0');
  document.getElementById('moduleTimer').textContent = `${m}:${s}`;
}

function startTimer(){
  clearInterval(moduleInterval);
  moduleInterval = setInterval(()=>{
    if(moduleTimeLeft > 0){
      moduleTimeLeft--;
      updateModuleTimer();
    } else {
      clearInterval(moduleInterval);
      alert("‚è∞ Time's up! Take a break.");
    }
  }, 1000);
}

function resetTimer(){
  clearInterval(moduleInterval);
  moduleTimeLeft = 25 * 60;
  updateModuleTimer();
}

updateModuleTimer();
</script>
</body>
</html>
